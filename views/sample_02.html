<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hello Uploader</title>
    <style>
        .document_file{
            background-color: rgb(203, 231, 177); 
            width:500px;
            padding: 5px;
        }
        .document_add{
            background-color: rgb(203, 231, 177); 
            width:500px;
            padding: 5px;
            text-align: right;
        }
        .document_submit{
            padding: 5px;
            width:500px;
            background-color: orange;
        }

    </style>
    <script>
        var number
        var file_id = 0;
        var doc_id = 0;

        function clickMore() {
            var file_container = document.getElementById("container");
            var number = file_container.childElementCount;
            console.log("clickMore() :"+number);
            var obj = document.createElement("INPUT");
            const obj_id = "f_"+file_id;
            obj.setAttribute("type", "file");
            obj.setAttribute("name", "files");
            obj.setAttribute("id", obj_id);
            
            var divObj = document.createElement("DIV");
            divObj.setAttribute("class", "document_file");
            divObj.appendChild(obj);
            
            file_container.appendChild(divObj);
        }
        function displayFile(obj){
            var files = document.getElementsByName('file');
            console.log(files.length);
            console.log(files);
        }

        async function uploadFile() {
            let formData = new FormData();

            const fileDocs = document.querySelectorAll('input[name="files"]');
            fileDocs.forEach(function(input){
                input.addEventListener('change',function(){
                    const file = this.files[0];
                    const fileName = file.name;
                    console.log(fileName);
                });
            });
            // formData.append("file", fileupload.files[0]);
            // let ans = await fetch('ajaxUpload/ajax', {
            //     method: "POST", 
            //     body: formData
            // }).then(function(res){ 
            //     console.log(res.json());
            // } ).catch(function(err){
            //     console.log(err);
            // }).finally(function(res){
            //     console.log("--Final------");
            //     alert('The file has been uploaded successfully.');
            // });
            // console.log(ans.json());
        }

    </script>
    
</head>
<body>
    <h1>Please upload file</h1>
    <div id="container">
        Ajax
        <div class="document_file">
            <input type="file" name="files" />      
        </div>        
    </div>
    <div>
        <div class="document_add">
            <a href="#" onclick="clickMore()">+more</a>
        </div>
        <div class="document_submit">
            <button id="upload-button" onclick="uploadFile()"> Upload </button>
        </div>
    </div>
</body>
</html>